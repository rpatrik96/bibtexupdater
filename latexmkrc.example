# latexmkrc.example - Bibliography filtering integration for latexmk
#
# This configuration runs filter_bibliography.py before bibtex/biber
# to include only cited references in your bibliography.
#
# NOTE: This does NOT work on Overleaf (missing bibtexparser package).
# For Overleaf, use the GitHub Actions workflow instead.
# See: docs/FILTER_BIBLIOGRAPHY.md
#
# Usage:
#   1. Copy this file to your project as 'latexmkrc' (no extension)
#   2. Adjust FILTER_SCRIPT path and BIB_FILE name below
#   3. Run: latexmk -pdf main.tex
#
# Requirements:
#   - Python 3 with bibtexparser: pip install bibtexparser
#   - filter_bibliography.py from https://github.com/rpatrik96/bibtexupdater

# ==============================================================================
# Configuration - Adjust these for your project
# ==============================================================================

# Path to filter_bibliography.py (absolute or relative to project)
$FILTER_SCRIPT = 'filter_bibliography.py';

# Your bibliography file name
$BIB_FILE = 'references.bib';

# ==============================================================================
# Latexmk settings
# ==============================================================================

# Use pdflatex by default
$pdf_mode = 1;

# Enable bibtex when needed
$bibtex_use = 2;

# ==============================================================================
# Bibliography filtering hook
# ==============================================================================

# Option 1: Filter before bibtex (overwrites original .bib)
# This filters the bibliography in-place before bibtex runs
$bibtex = "python $FILTER_SCRIPT %R.tex $BIB_FILE -o $BIB_FILE --no-warn-missing && bibtex %O %B";

# Option 2: Filter to separate file (preserves original)
# Uncomment this and update your \bibliography{} to use references_filtered
# $bibtex = "python $FILTER_SCRIPT %R.tex $BIB_FILE -o ${BIB_FILE}_filtered.bib --no-warn-missing && bibtex %O %B";

# Option 3: For biber backend (biblatex)
# $biber = "python $FILTER_SCRIPT %R.tex $BIB_FILE -o $BIB_FILE --no-warn-missing && biber %O %S";

# ==============================================================================
# Additional options
# ==============================================================================

# Uncomment to recursively scan subdirectories for .tex files
# $bibtex = "python $FILTER_SCRIPT . $BIB_FILE -o $BIB_FILE -r --no-warn-missing && bibtex %O %B";

# Uncomment for verbose output during compilation
# $bibtex = "python $FILTER_SCRIPT %R.tex $BIB_FILE -o $BIB_FILE -v && bibtex %O %B";
